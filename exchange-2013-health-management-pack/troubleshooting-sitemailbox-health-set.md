---
title: SiteMailbox 正常性セットのトラブルシューティング
TOCTitle: SiteMailbox 正常性セットのトラブルシューティング
ms:assetid: ac00985c-c9a5-44bf-b152-4b99d8ae24ed
ms:mtpsurl: https://technet.microsoft.com/ja-jp/library/ms.exch.scom.sitemailbox(v=EXCHG.150)
ms:contentKeyID: 53181824
ms.date: 01/28/2016
mtps_version: v=EXCHG.150
ms.translationtype: HT
---

# SiteMailbox 正常性セットのトラブルシューティング

 

_**適用先:**  Exchange Server 2013, Project Server 2013_

_**トピックの最終更新日:**  2013-02-11_

SiteMailbox 正常性セットは、組織内のサイト メールボックスの全体的な状態とアクセス可能性を監視します。

SiteMailbox が正常でないことを示す警告を受け取った場合、それは、ユーザーのメールボックスの内容が同期状態にないことを示しています。

## 説明

SiteMailbox 監視システムは、バックグラウンド同期サービスからパッシブな同期結果を受け取ります。このシステムは、プローブを使用しません。パッシブな同期結果は、同期が試行されるたびに、SiteMailbox 監視システムに書き込まれます。同期は、次のイベントが発生したときにも実行されます。

  - Outlook または Outlook Web App を使用して、ユーザーが自分のサイト メールボックスにアクセスする

  - **Update-SiteMailbox** コマンドを実行する

  - Outlook Web App の \[オプション\] ウィンドウを開き、選択したサイト メールボックスの <strong>同期の状態</strong> ページの <strong>同期の開始</strong> ボタンをクリックする

Update-SiteMailbox コマンドレットの詳細については、「[Update-SiteMailbox](https://technet.microsoft.com/ja-jp/library/jj218690\(v=exchg.150\))」を参照してください。

プローブとモニターの詳細については、「[サーバーの状態とパフォーマンス](https://technet.microsoft.com/ja-jp/library/jj150551\(v=exchg.150\))」を参照してください。

## 一般的な問題

同期監視サービスで警告が生成されるのは、一般に、サイト全体に対する同期問題が発生したときです。1 つのサイト メールボックスで同期が失敗した場合、警告は送信されません。しきい値を超える警告が 1 つのサイト メールボックスを対象としたものである場合、その原因を突き止めるには、サイト メールボックスの同期ログ ファイルを参照することをお勧めします。

## ユーザー操作

サービスは、警告の発行後に回復することがあります。そのため、正常性セットが異常であることを示す警告を受け取ったときは、まず、その問題がまだ存在しているかどうかを確認します。問題が存在する場合は、次のセクションで説明する適切な回復操作を実行します。

## 問題がまだ存在していることを確認する

1.  警告に記載された正常性セット名とサーバー名を確認します。

2.  メッセージの詳細には、警告の正確な原因に関する情報が示されています。ほとんどの場合、根本原因を特定するためのトラブルシューティング情報としては、メッセージの詳細だけで十分です。メッセージの詳細が不明確な場合は、次の操作を行います。
    
    1.  Exchange 管理シェル を開き、次のコマンドを実行して、警告を発行した正常性セットの詳細を取得します。
        
            Get-ServerHealth <server name> | ?{$_.HealthSetName -eq "<health set name>"}
        
        たとえば、server1.contoso.com に関する SiteMailbox 正常性セットの詳細を取得するには、次のコマンドを実行します。
        
            Get-ServerHealth server1.contoso.com | ?{$_.HealthSetName -eq "SiteMailbox"}
    
    2.  コマンド出力を確認して、エラーを報告したモニターを特定します。警告を発行したモニターの **AlertValue** の値は `Unhealthy` になります。

## トラブルシューティングの手順

正常性セットから警告を受け取ったときは、電子メール メッセージに次の情報が含まれています。

  - 警告を送信したサーバーの名前

  - 警告の発生日時

  - 使用された認証メカニズムと資格情報

  - 最後のエラーの完全な例外の追跡 (診断データおよび特定の HTTP ヘッダー情報を含む)  
    
    **注**   完全な例外の追跡に記載された情報を使用して、問題をトラブルシューティングできます。プローブによって生成された例外には、プローブが失敗した理由を説明する「エラーの理由」が含まれています。

**バックグラウンド同期のエラー**

バックグラウンドの同期プロセスが失敗すると、次のような警告を受信することがあります。

サイト メールボックスのバックグラウンド同期が 25% 以上失敗しています:87 試行で 41 エラーが発生しました。サンプル同期結果:

\[メッセージ: リモート サーバーはエラーを返しました: (401) 権限がありません。\]\[種類: System.Net.WebException\]

この警告が生成されるのは、過去 4 時間の間に、定常的に高い割合で同期エラーが発生した場合です。警告が送信されるのは、検出漏れを避けるため、過去 4 時間の 15 分の時間枠内で次の条件が満たされている場合のみです。

  - 15 分の時間枠内にエラーが 20 回以上発生している。

  - 総試行に対するエラーの発生比率が 15 分の時間枠内で 25% を超えている。

Exchange のすべてのサイト メールボックスは、SharePoint サイトにリンクされます。メールボックス ロールをホストしている特定の Exchange サーバー上のサイト メールボックスごとに、サーバーは、サイト メールボックス関連の情報を SharePoint から同期します。

このプロセスでは、2 種類の同期 (メンバーシップ同期とドキュメント同期) が実行されます。これらの同期プロセスのメタデータは、さまざまな Web サービスから得られます。さらに、特定の Exchange サーバーには、複数の SharePoint サーバーまたはファームにリンクされたサイト メールボックスが含まれることがあります。したがって、警告は、次の状態に応じて複数のメールボックス サーバーから発生することがあります。

1.  組織内でよく使用されているサイト メールボックスの分布状況

2.  よく使用されているサイト メールボックスがリンクされている先の SharePoint サーバー

3.  警告しきい値に見合うだけの十分な同期ボリュームがメールボックス サーバーにあるかどうか

この問題を解決する場合、警告内のサンプル同期結果がエラー原因の特定に役立つことがあります。同期試行の成功または失敗の詳細は、*\<exExchangeSvrNoVersion installation directory\>*Logging\\TeamMailbox フォルダーに記録されます。最新の Microsoft.Exchange.ServiceHost\_TeamMailboxSyncLog\* ファイルを参照し、**failed** という語を検索して、エラーを確認してください。また、**Test-OAuthConnectivity**、**Test-SiteMailbox**、および **Get-SiteMailboxDiagnostics** コマンドレットを使用して、さらにトラブルシューティングを行うこともできます。

**MSExchangeServiceHost サービスが実行されていない**

MSExchangeServiceHost サービスが実行されていない場合、次のような警告を受信します。

回復試行後、'MSExchangeServiceHost' サービスが実行されていません。サービスが無効になったか、クラッシュ ループに入った可能性があります。

この問題を解決するには、警告を送信したサーバーで MSExchangeServiceHost サービスが実行されていることを確認します。サービスが実行されている場合は、Windows イベント ログを参照し、以前にサービスが実行されていなかった原因を示す内容 (サービスが手動で制御されていた、サービスが繰り返しクラッシュしたなど) がないかどうかを確認します。

**MSExchangeServiceHost サービスがクラッシュした**

MSExchangeServiceHost サービスがクラッシュした場合、次のような警告を受信します。

MSExchangeServiceHost プロセスは最後の 60 分間に 3 回以上クラッシュしています。  
ワトソン メッセージ:

\<*メッセージ*\>

この問題を解決するには、MSExchangeServiceHost サービスについて **4999** イベントの警告を送信したサーバー上の Windows アプリケーション イベント ログを確認します。詳細なテキストにより、問題の原因について情報を得ることができます。

## 詳細情報

[Exchange 2013 の新機能](https://technet.microsoft.com/ja-jp/library/jj150540\(v=exchg.150\))

[Exchange 2013 コマンドレット](https://technet.microsoft.com/ja-jp/library/bb124413\(v=exchg.150\))

