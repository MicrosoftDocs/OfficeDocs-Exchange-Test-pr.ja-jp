---
title: 'ハイブリッド移行の場合のパフォーマンス要因とベスト プラクティス: Exchange 2013 Help'
TOCTitle: ハイブリッド移行の場合のパフォーマンス要因とベスト プラクティス
ms:assetid: 120a7832-d2d3-47d7-b305-918360c2ef66
ms:mtpsurl: https://technet.microsoft.com/ja-jp/library/Mt483789(v=EXCHG.150)
ms:contentKeyID: 70117982
ms.date: 01/11/2018
mtps_version: v=EXCHG.150
ms.translationtype: HT
---

# ハイブリッド移行の場合のパフォーマンス要因とベスト プラクティス

 

_<strong>適用先:</strong>Exchange Server 2016_

_<strong>トピックの最終更新日:</strong>2016-12-09_

オンプレミスのメール組織から Office 365 にデータを移行するパスはいくつもあります。Office 365 への移行を計画する場合のよくある質問は、どうすればデータ移行のパフォーマンスを向上させ、移行速度を最適化できるかということです。この記事では、Exchange のハイブリッド展開に対応した移行パフォーマンスについて説明します。その他の移行方法に関するパフォーマンス情報については、「[Office 365 移行のパフォーマンスとベスト プラクティス](http://go.microsoft.com/fwlink/p/?linkid=623651)」を参照してください。

## ハイブリッド移行の場合のパフォーマンス要因とベスト プラクティス

ハイブリッド展開の移行では、オンプレミスの Exchange サーバーと、Office 365 の Exchange Online との間での円滑な移行がサポートされます。

ハイブリッド展開での移行は、メールボックス データを Office 365 に移行する方法の中で間違いなく最速の方法です。 実際のお客様の展開では、最大 100 GB/時間のスループットを確認しています。以下の表に、ネイティブ Office 365 ハイブリッド移行シナリオに適用される要因をリストします。

地理的に分散された複数のサイトがオンプレミス環境に含まれている場合は、地理的に近くにある移行エンドポイントを作成することで移行のパフォーマンスを向上できます。これは、オンプレミスのネットワークを使用する一元的な移行エンドポイントを使用する場合に匹敵する、Microsoft のネットワークを使用する移行などのシナリオがあるからです。

## 要因 1:データ ソース (Exchange Server)


<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>チェックリスト</th>
<th>説明</th>
<th>ベスト プラクティス</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>システムのパフォーマンス</p></td>
<td><p>データ抽出は、リソースを集中的に使用するタスクです。移行のパフォーマンスを向上させるには、移行元システムに十分なリソース (CPU 時間やメモリなど) が必要です。多くの場合、移行時の移行元システムは、通常のエンド ユーザーの負荷で限界近くまでキャパシティを利用しています。移行によって追加の負荷がかかると、システム リソースの不足により、エンド ユーザーのアクセス速度がさらに低下することがあります。</p></td>
<td><p>パイロット移行テスト時に、システムのパフォーマンスを監視します。システムがビジー状態の場合は、移行の速度が遅くなったり、サービスの利用に問題が発生したりする可能性があるため、特定のシステムに集中した移行をスケジュールしないことをお勧めします。可能であれば、ハードウェア リソースを追加し、タスクやユーザーを移行に関係のない他のサーバーに移動することでシステムの負荷を軽減して、移行元システムのパフォーマンスを高めます。</p>
<p>詳細については、次のトピックを参照してください。</p>
<ul>
<li><p><a href="https://blogs.technet.microsoft.com/exchangeteamjp/2015/10/28/exchange-2016-12464/">パフォーマンス チームに聞く:Exchange 2016 展開環境のサイジング</a></p></li>
<li><p><a href="https://technet.microsoft.com/ja-jp/library/jj150551(v=exchg.150)">サーバーの状態とパフォーマンス</a></p></li>
<li><p><a href="http://technet.microsoft.com/ja-jp/library/dd351192.aspx">Exchange のパフォーマンスについて</a></p></li>
</ul>
<p>複数のメールボックス サーバーおよび複数のデータベースが存在する社内 Exchange 組織から移行する場合は、それら複数のメールボックス サーバーおよびデータベースに均等に分散された移行ユーザーの一覧を作成することをお勧めします。個別のサーバーのパフォーマンスに基づいて、この一覧をさらに微調整し、スループットを最大化できます。</p>
<p>例えば、サーバー A のリソースの利用可能時間がサーバー B よりも 50% 長い場合は、同じ移行バッチにおいてサーバー A からのユーザー数を 50% 多くするのが適切です。他の移行元システムに対しても、同様のプラクティスを適用できます。</p>
<p>勤務時間後、週末、祝日など、サーバー リソースの利用可能時間が最大になるときに移行を実行します。</p></td>
</tr>
<tr class="even">
<td><p>バックエンド タスク</p></td>
<td><p>移行時に実行されている他のバックエンド タスク。移行は勤務時間後に実行するのがベスト プラクティスなので、社内のサーバーで実行中の他の保守タスク (データのバックアップなど) と競合することがよくあります。</p></td>
<td><p>移行中に実行される可能性がある他のシステム タスクを確認します。データの移行は、リソースを大量に消費する他のタスクが実行されていないときに実施することをお勧めします。</p>
<p><strong>注意</strong> 社内で Microsoft Exchange を使用しているお客様にとって一般的なバックエンド タスクには、バックアップ ソリューションや <a href="http://technet.microsoft.com/ja-jp/library/aa996226(exchg.65).aspx">「Exchange ストアの保守」</a>があります。</p></td>
</tr>
</tbody>
</table>


## 要因 2:移行サーバー

ハイブリッド展開の移行は、クラウドから開始されるデータのプル/プッシュ型の移行であり、Exchange ハイブリッド サーバーが移行サーバーとして動作します。この点が見落とされて、ハイブリッド サーバーとして性能の低い仮想マシンが使用されることがよくあります。これにより移行のパフォーマンスが低下します。

**ベスト プラクティス**

前述のベスト プラクティスを適用することに加えて、次のベスト プラクティスを試した結果、実際のお客様の移行において移行のパフォーマンスが向上しました。

  - Exchange ハイブリッド サーバーには、仮想マシンではなく、強力なサーバークラスの物理コンピューターを使用します。

  - お客様のネットワーク ロード バランサーの背後に配置された複数のハイブリッド サーバーを使用します。

例えば、実際のお客様の移行では、次の構成を使用することによって、一貫して 30 GB/時のスループットを達成しました。

  - **ネットワーク**  インターネットへの 500 MB の送信用回線 (10 GB のファイバー バックボーンをもつ 1 GB の内部ネットワーク)。

  - **ハードウェア**   2 台のクライアント アクセス/ハブ (物理) サーバーの仕様:
    
      - CPU: Intel® Xeon® CPU E5520 @ 2.27 GHz 2.26 GHz (2 つのプロセッサ)。
    
      - RAM: 24 GB
    
      - ディスク: 146 GB のディスク 8 台。RAID 5 構成、合計で 960 GB の使用可能領域。

  - **MRSProxy**   同時実行 100 で構成されます。

## 要因 3:移行エンジン

ハイブリッド展開の移行では、ネイティブ Office 365 ツールを使用します。これは、Office 365 移行サービスの調整の対象になります。

**Exchange 2003 および Exchange の最新のバージョン**

Exchange 2003 からの移行時のエンド ユーザー エクスペリエンスには、重要な相違点があります。Exchange の最新バージョンとは異なり、Exchange 2003 のエンド ユーザーは、メールボックス データの移行中はメールボックスにアクセスできません。したがって、Exchange 2003 を使用しているお客様は、通常、移行をスケジュールする時刻および移行に必要な時間について注意を払う必要があります。特に、メールボックスのサイズが大きい、またはネットワーク速度が遅いなどの理由で移行のパフォーマンスが低い場合には注意が必要です。

また、Exchange 2003 の移行は、中断による影響を大きく受けます。例えば、実際のお客様が 10 GB のメールボックスを移行中に、メールボックスの移行が 50% 完了したところでサービス インシデントが発生しました。この問題を解決するには、データの移行を処理していた Office 365 クライアント アクセス サーバーを再起動する必要がありました。この場合、このメールボックスの移行を最初からやり直す必要がありました。つまり、お客様は 10 GB のデータすべてを再度移行する必要がありました。停止したポイントから移行を再開することはできませんでした。一方、Exchange 2010 以降のバージョンでは、中断後に移行を再開できます。

**ベスト プラクティス**

大規模で重要な Exchange 2003 メールボックスの場合は、2 ホップの移行を選択するお客様もいます。

  - **最初のホップ** Exchange 2003 から Exchange 2010 以降のサーバー (通常はハイブリッド サーバー) にメールボックスを移行します。最初のホップはオフラインの移動ですが、通常は、ローカル ネットワークを経由した非常に高速な移行です。

  - **2 番目のホップ** Exchange 2010 以降のバージョンから Office 365 にメールボックスを移行します。

2 番目のホップは、オンライン移動で、より優れたユーザー エクスペリエンスとフォールト トレランスを提供します。この 2 ホップのアプローチを使用する場合は、一時的なオンプレミスのユーザー メールボックス用に Exchange ライセンスが必要です。

**Mailbox Replication サービス プロキシ (MRSProxy)**

MRS プロキシは社内の移行機能であり、Office 365 側で実行される Mailbox Replication サービスと連携して動作します。詳細については、「[移動要求について](http://technet.microsoft.com/ja-jp/library/dd298174.aspx)」をご覧ください。

**ベスト プラクティス**

オンプレミスの Exchange ハイブリッド サーバーに対して、MRSProxy 接続の最大数を構成できます。次の Windows PowerShell コマンドを実行します。

    Set-WebServicesVirtualDirectory -Identity "EWS (Default Web Site)" -MRSMaxConnections <number between 0 and unlimited; default is 100>


> [!NOTE]
> ほとんどのお客様の移行では、既定の MRSMaxConnections 値を変更する必要はありません。移行元サーバーが移行の負荷によって過負荷状態になることを防止する必要がある場合は、接続数を減らすことができます。この設定は、MRSProxy サーバーごとの設定です。お客様が 2 台の MRSProxy サーバーを使用しており、それぞれに 10 の接続を設定した場合、MRSProxy 接続の合計数は 20 (2 x 10) となります。社内 Exchange 2010 組織における MRSProxy サービスの構成の詳細については、「<A href="http://technet.microsoft.com/ja-jp/library/ee732395.aspx">リモート クライアント アクセス サーバーで MRSProxy サービスを開始する</A>」をご覧ください。



## 要因 4:ネットワーク

**検証テスト**

Exchange 2010 以降を使用しているお客様は、複数のテスト メールボックスの移行を実行することによって、ハイブリッド移行のネットワーク パフォーマンスをテストできます。または、-SuspendWhenReadyToComplete オプションを指定して実際のユーザー メールボックスを移行し、移行のパフォーマンスについての情報を表示できます。テストが完了したら、エンド ユーザーへの影響がないように移動要求を削除します。

移動要求の詳細については、「[New-MoveRequest](https://technet.microsoft.com/ja-jp/library/dd351123\(v=exchg.150\))」を参照してください。

## 要因 5:Office 365 サービス

Office 365 のリソース正常性ベースの調整は、Office 365 ハイブリッド展開の移行を使用した場合の移行に影響します。詳細については、上記 Office 365 のリソース正常性ベースの調整セクションを参照してください。

