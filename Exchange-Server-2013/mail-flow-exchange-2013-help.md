---
title: 'メール フロー: Exchange 2013 Help'
TOCTitle: メール フロー
ms:assetid: 14df5e1a-a5f7-4b0d-ba97-f53b76f0e7e0
ms:mtpsurl: https://technet.microsoft.com/ja-jp/library/Aa996349(v=EXCHG.150)
ms:contentKeyID: 48269199
ms.date: 04/24/2018
mtps_version: v=EXCHG.150
ms.translationtype: HT
---

# メール フロー

 

_**適用先:** Exchange Server 2013_

_**トピックの最終更新日:** 2015-03-09_

Microsoft Exchange Server 2013 では、メールフローはトランスポート パイプラインを経由して発生します。*トランスポート パイプライン*は、組織内のメールボックス サーバー上のトランスポート サービスのカテゴライザーにすべてのメッセージをルーティングするために連携して動作する、サービス、接続、コンポーネント、およびキューの集まりです。

メール フローに関するすべてのトピックの一覧については、「メール フロー ドキュメント」を参照してください。

新しい Exchange 2013 組織におけるメール フローの構成方法については、「[メール フローおよびクライアント アクセスの構成](configure-mail-flow-and-client-access-exchange-2013-help.md)」を参照してください。

**目次**

トランスポート パイプライン

メールボックス サーバー上のトランスポート サービス

メール フロー ドキュメント

## トランスポート パイプライン

トランスポート パイプラインは、次のサービスで構成されています。

  - **クライアント アクセス サーバー上のフロント エンド トランスポート サービス**   このサービスは、Exchange 2013 組織のすべての受信用と (オプションで) 送信用の外部 SMTP トラフィックのステートレス プロキシとして機能します。フロント エンド トランスポート サービスは、メッセージの内容を検査せず、メールボックス サーバー上のメールボックス トランスポート サービスと通信せず、どのメッセージもローカルでキューに入れません。

  - **メールボックス サーバー上のトランスポート サービス**   このサービスは、以前のバージョンの Exchange のハブ トランスポート サーバーの役割と実質的に同じです。トランスポート サービスは、組織のすべての SMTP メールフローを処理し、メッセージを分類し、メッセージの内容を検査します。以前のバージョンの Exchange とは異なり、トランスポート サービスは、メールボックス データベースと直接通信しません。この作業は、メールボックス トランスポート サービスによって処理されるようになりました。トランスポート サービスは、メールボックス トランスポート サービス、トランスポート サービス、フロント エンド トランスポート サービス、および (構成によって異なる) エッジ トランスポート サーバー上のトランスポート サービス間でメッセージをルーティングします。メールボックス サーバー上のトランスポート サービスの詳細は後述します。

  - **メールボックス サーバー上のメールボックス トランスポート サービス**   このサービスは、メールボックス トランスポート送信サービスとメールボックス トランスポート配信サービスの 2 つのサービスで構成されています。メールボックス トランスポート配信サービスは、ローカル メールボックス サーバーまたはその他のメールボックス サーバー上のトランスポート サービスから SMTP メッセージを受信し、Exchange リモート プロシージャ コール (RPC) を使用してローカル メールボックス データベースに接続しメッセージを配信します。メールボックス トランスポート発信サービスは、RPC を使用してローカル メールボックス データベースに接続してメッセージを取得し、ローカル メールボックス サーバーや他のメールボックス サーバーのトランスポート サービスに SMTP でメッセージを発信します。メールボックス トランスポート発信サービスは、トランスポート サービスと同じルーティング トポロジ情報にアクセスします。フロント エンド トランスポート サービス同様、メールボックス トランスポート サービスもメッセージをローカルにキューに格納しません。

  - **エッジ トランスポート サーバー上のトランスポート サービス**   このサービスは、メールボックス サーバー上のトランスポート サービスと非常によく似ています。境界ネットワークにエッジ トランスポート サーバーがインストールされている場合は、インターネットとの間で送受信するすべてのメールがトランスポート サービス エッジ トランスポート サーバー経由で転送されます。このサービスの詳細は後述します。

次の図は、Exchange 2013 トランスポート パイプライン内のコンポーネント間の関係を示しています。

**Exchange 2013 のトランスポート パイプラインの概要**

![トランスポート パイプラインの概要図](images/Aa996349.6f548b64-6ac2-4e98-9098-69ad6cd9f569(EXCHG.150).gif "トランスポート パイプラインの概要図")

## 外部送信者からのメッセージ

組織の外部からのメッセージは、クライアント アクセス サーバー上のフロント エンド トランスポート サービスの受信コネクタ経由でトランスポート パイプラインに入った後、メールボックス サーバー上のトランスポート サービスにルーティングされます。

境界ネットワークに Exchange 2013 エッジ トランスポート サーバーがインストールされている場合は、組織の外部からのメッセージがエッジ トランスポート サーバー上のトランスポート サービスの受信コネクタ経由でトランスポート パイプラインに入ります。メッセージの次の行き先は、内部 Exchange サーバーの構成によって異なります。

  - **同じコンピューター上にインストールされたメールボックス サーバーとクライアント アクセス サーバー**   この構成では、クライアント アクセス サーバーが受信メール フローに使用されます。メールはエッジ トランスポート サーバー上のトランスポート サービスからクライアント アクセス サーバー上のフロント エンド トランスポート サービスに転送された後、メールボックス サーバー上のトランスポート サービスに転送されます。

  - **別々のコンピューター上にインストールされたメールボックス サーバーとクライアント アクセス サーバー**   この構成では、クライアント アクセス サーバーが受信メール フローに使用されません。メールは、エッジ トランスポート サーバー上のトランスポート サービスからメールボックス サーバー上のトランスポート サービスに転送されます。


> [!NOTE]
> 境界ネットワークに Exchange 2010 エッジ トランスポート サーバーまたは Exchange&nbsp;2007 エッジ トランスポート サーバーがインストールされている場合、メール フローは常にエッジ トランスポート サーバーとメールボックス サーバー上のトランスポート サーバー間で発生します。詳細については、「<A href="use-an-exchange-2010-or-2007-edge-transport-server-in-exchange-2013-exchange-2013-help.md">Exchange 2013 での Exchange 2010 または 2007 エッジ トランスポート サーバーの使用</A>」を参照してください。



## 内部送信者からのメッセージ

組織の内部からの SMTP メッセージは、次のいずれかの方法で、メールボックス サーバー上のトランスポート サービス経由でトランスポート パイプラインに入ります。

  - 受信コネクタ経由。

  - ピックアップ ディレクトリまたは再生ディレクトリから。

  - メールボックス トランスポート サービスから。

  - エージェントの発信によって。

メッセージは、ルーティング先または配信グループに基づいてルーティングされます。詳細については、「[メール ルーティング](mail-routing-exchange-2013-help.md)」を参照してください。

メッセージに外部受信者が含まれている場合は、そのメッセージがメールボックス サーバー上のトランスポート サービスからインターネットにルーティングされるか、送信コネクタがクライアント アクセス サーバー経由で送信接続をプロキシするように構成されていれば、メールボックス サーバーからクライアント アクセス サーバー上のフロント エンド トランスポート サービスにルーティングされてから、インターネットにルーティングされます。詳細については、「[インターネットへの電子メール送信に対応した送信コネクタの作成](create-a-send-connector-for-email-sent-to-the-internet-exchange-2013-help.md)」を参照してください。

境界ネットワークにエッジ トランスポート サーバーがインストールされている場合、外部受信者を含むメッセージがクライアント アクセス サーバー上のフロント エンド トランスポート サービス経由でルーティングされることはありません。メッセージは、メールボックス サーバー上のトランスポート サービスからエッジ トランスポート サーバー上のトランスポート サービスにルーティングされます。

## メールボックス サーバー上のトランスポート サービス

Exchange 2013 組織内で送受信されるメッセージはすべて、ルーティングと配信の前に、メールボックス サーバー上のトランスポート サービスで分類される必要があります。分類されたメッセージは、送信先メールボックス データベース、送信先データベース可用性グループ (DAG)、Active Directory サイト、Active Directory フォレスト、あるいは組織の外部の送信先ドメインに配信されるため、配信キューに格納されます。

メールボックス サーバー上のトランスポート サービスは、次のコンポーネントおよびプロセスで構成されています。

  - **SMTP 受信**   メッセージがハブ トランスポート サービスによって受信されると、メッセージの内容が検査され、トランスポート ルールが適用され、さらにスパム対策およびマルウェア対策ソフトウェアが有効な場合は、これらのソフトウエアによって検査されます。SMTP セッションには、メッセージを受け付ける前にその内容を検証するために、特定の順序で連携して機能する一連のイベントがあります。メッセージが SMTP 受信を完全に通過して、受信イベント、またはスパム対策エージェントとマルウェア対策エージェントによって拒否されなかった場合、そのメッセージは送信キューに格納されます。

  - **発信**   発信とは、メッセージを送信キューに格納するプロセスです。カテゴライザーは、一度に 1 つのメッセージを取得して分類します。発信には、次の 3 種類があります。
    
      - 受信コネクタ経由の SMTP 受信から。
    
      - ピックアップ ディレクトリまたは再生ディレクトリ経由。これらのディレクトリはメールボックス サーバーとエッジ トランスポート サーバー上に存在します。ピックアップ ディレクトリまたは再生ディレクトリにコピーされた正しい形式のメッセージ ファイルは、送信キューに直接格納されます。
    
      - トランスポート エージェント経由。

  - **カテゴライザー**   カテゴライザーは、送信キューから一度に 1 つのメッセージを取得します。カテゴライザーは、次の手順を実行します。
    
      - 最上位のアドレス指定、展開、分岐を含む受信者の解決。
    
      - ルーティングの解決。
    
      - コンテンツ変換。
    
    さらに、組織によって定義されたメール フロー ルールが適用されます。メッセージは、分類された後、メッセージの送信先に基づいた配信キューに格納されます。メッセージは、送信先メールボックス データベース、DAG、Active Directory サイト、Active Directory フォレスト、または外部ドメインによってキューに格納されます。

  - **SMTP 送信**   トランスポート サービスからのメッセージのルーティング方法は、分類が行われたメールボックス サーバーに対するメッセージの受信者の位置によって決定されます。メッセージは次の場所のいずれかにルーティングできます。
    
      - 同じメールボックス サーバー上のメールボックス トランスポート サービス。
    
      - 同じ DAG の一部である別のメールボックス サーバー上のメールボックス トランスポート サービス。
    
      - 別の DAG、Active Directory サイト、または Active Directory フォレスト内のメールボックス サーバー上のトランスポート サービス。
    
      - 同じメールボックス サーバー上の送信コネクタ経由、別のメールボックス サーバー上のトランスポート サービス経由、クライアント アクセス サーバー上のフロント エンド トランスポート サービス経由、または境界ネットワーク内のエッジ トランスポート サーバー上のトランスポート サービス経由のインターネット配信の場合。

## エッジ トランスポート サーバー上のトランスポート サービス

エッジ トランスポート サーバー上のトランスポート サービスのコンポーネントは、メールボックス サーバー上のトランスポート サービスのコンポーネントと全く同じです。ただし、エッジ トランスポート サーバー上の処理の各段階で実際に起きることは異なります。次のリストでこの違いを説明します。

  - **SMTP 受信**   エッジ トランスポート サーバーが内部の Active Directory サイトにサブスクライブされている場合は、既定の受信コネクタが自動的に内部のメールボックス サーバーとインターネットからのメールを受け入れるように構成されます。インターネット メッセージがエッジ トランスポート サーバーに到着すると、スパム対策エージェントが接続とメッセージの内容をフィルター処理して、組織によるメッセージの受信中の送信者と受信者の特定を支援します。スパム対策エージェントは既定でインストールされ、有効になっています。他の添付ファイル フィルター機能と接続フィルター機能は使用できますが、組み込みのマルウェア フィルターは使用できません。また、トランスポート ルールは、エッジ ルール エージェントによって制御されます。メールボックス サーバー上のトランスポート ルールに比べて、エッジ トランスポート サーバー上のトランスポート ルール条件はほんの一部しか使用できません。ただし、エッジ トランスポート サーバーでのみ利用可能な SMTP 接続に関連した特有のトランスポート ルール アクションがあります。

  - **送信**   エッジ トランスポート サーバーでは、通常、メッセージが受信コネクタ経由で送信キューに入ります。ただし、ピックアップ ディレクトリと再生ディレクトリを使用することもできます。

  - **カテゴライザー**   エッジ トランスポート サーバーにおける分類は、メッセージが内部または外部の受信者に配信するための配信キューに直接入れられる短時間のプロセスです。

  - **SMTP 送信**   エッジ トランスポート サーバーが内部の Active Directory サイトにサブスクライブされている場合は、2 つの送信コネクタが自動的に作成され、構成されます。1 つはインターネット受信者への送信メールの送信を担当し、もう 1 つはインターネットから内部の受信者への受信メールの送信を担当します。受信メールは、サブスクライブ先の Active Directory サイト内で使用可能なメールボックス サーバー上のトランスポート サービスに送信されます。

## メール フロー ドキュメント

次の表に、Exchange 2013 のメール フローの学習や管理に役立つピックへのリンクを示します。


<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>トピック</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><a href="mail-routing-exchange-2013-help.md">メール ルーティング</a></p></td>
<td><p>メールのルーティングでは、メッセージング サーバー間のメッセージの送信方法について説明します。</p></td>
</tr>
<tr class="even">
<td><p><a href="connectors-exchange-2013-help.md">コネクタ</a></p></td>
<td><p>コネクタは、 Exchange サーバーとの間でメッセージが送受信される場所と方法を定義します。</p></td>
</tr>
<tr class="odd">
<td><p><a href="domains-exchange-2013-help.md">ドメイン</a></p></td>
<td><p>承認済みドメインは、Exchange 組織で使用する SMTP アドレス スペースを定義します。リモート ドメインは、外部ドメインに送信するメッセージの書式設定とエンコードの設定を構成します。</p></td>
</tr>
<tr class="even">
<td><p><a href="transport-agents-exchange-2013-help.md">トランスポート エージェント</a></p></td>
<td><p>トランスポート エージェントは Exchange トランスポート パイプラインを通過するメッセージを処理します。</p></td>
</tr>
<tr class="odd">
<td><p><a href="transport-high-availability-exchange-2013-help.md">トランスポートの高可用性</a></p></td>
<td><p>トランスポートの高可用性では、転送時と配信後のメッセージの冗長コピーを Exchange 2013 が保存する方法を説明します。</p></td>
</tr>
<tr class="even">
<td><p><a href="transport-logs-exchange-2013-help.md">トランスポート ログ</a></p></td>
<td><p>トランスポート ログは、トランスポート パイプラインを通過するメッセージの処理内容を記録します。</p></td>
</tr>
<tr class="odd">
<td><p><a href="https://docs.microsoft.com/ja-jp/exchange/security-and-compliance/mail-flow-rules/manage-message-approval">メッセージ承認の管理</a></p></td>
<td><p>モデレート トランスポートには、特定の受信者に送信されるメッセージに対する承認が必要です。</p></td>
</tr>
<tr class="even">
<td><p><a href="content-conversion-exchange-2013-help.md">コンテンツ変換</a></p></td>
<td><p>コンテンツ変換は、外部受信者向けには TNEF (Transport Neutral Encoding Format) メッセージ変換オプションを制御し、内部受信者向けには MAPI 変換オプションを制御します。</p></td>
</tr>
<tr class="odd">
<td><p><a href="dsns-and-ndrs-in-exchange-2013-exchange-2013-help.md">Exchange 2013 の DSN と NDR</a></p></td>
<td><p>配信状態通知 (DSN) は、配信不能レポート (NDR) など、メッセージ送信者に送信されるシステム メッセージです。</p></td>
</tr>
<tr class="even">
<td><p><a href="track-messages-with-delivery-reports-exchange-2013-help.md">配信レポートによるメッセージの追跡</a></p></td>
<td><p>配信レポートとは、組織のアドレス帳に登録されているユーザーが送受信した特定の件名のメール メッセージの配信状態を検索できるメッセージ追跡ツールです。組織の特定のメールボックスで送受信されたメッセージに関する配信情報を追跡できます。</p></td>
</tr>
<tr class="odd">
<td><p><a href="message-size-limits-exchange-2013-help.md">メッセージ サイズの制限</a></p></td>
<td><p>このトピックでは、メッセージに適用されるサイズ制限と個々のコンポーネントの制限について説明します。</p></td>
</tr>
<tr class="even">
<td><p><a href="queue-viewer-exchange-2013-help.md">キュー ビューアー</a></p></td>
<td><p>Exchange ツールボックスのキュー ビューアーでは、キューと、キュー内のメッセージを表示し、操作できます。</p></td>
</tr>
<tr class="odd">
<td><p><a href="pickup-directory-and-replay-directory-exchange-2013-help.md">ピックアップ ディレクトリと再生ディレクトリ</a></p></td>
<td><p>ピックアップ ディレクトリと再生ディレクトリは、トランスポート パイプラインにメッセージを挿入するために使用されます。</p></td>
</tr>
<tr class="even">
<td><p><a href="use-an-exchange-2010-or-2007-edge-transport-server-in-exchange-2013-exchange-2013-help.md">Exchange 2013 での Exchange 2010 または 2007 エッジ トランスポート サーバーの使用</a></p></td>
<td><p>このトピックでは、Exchange 2013 で以前のバージョンの Exchange のエッジ トランスポート サーバーを使用する際の考慮事項について説明します。</p></td>
</tr>
</tbody>
</table>

