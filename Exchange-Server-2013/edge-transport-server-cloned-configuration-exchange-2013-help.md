---
title: 'エッジ トランスポート サーバーの複製構成: Exchange 2013 Help'
TOCTitle: エッジ トランスポート サーバーの複製構成
ms:assetid: 683a6b8a-59bf-43ed-96c8-504945c2f665
ms:mtpsurl: https://technet.microsoft.com/ja-jp/library/Aa998622(v=EXCHG.150)
ms:contentKeyID: 61180557
ms.date: 04/24/2018
mtps_version: v=EXCHG.150
ms.translationtype: HT
---

# エッジ トランスポート サーバーの複製構成

 

_**適用先:**Exchange Server 2013_

_**トピックの最終更新日:**2015-03-09_

エッジ トランスポート サーバーは、自身の構成情報を Active Directory Lightweight Directory Services (AD LDS) に格納します。境界ネットワーク内に複数のエッジ トランスポート サーバーをインストールし、DNS ラウンド ロビンを使用して、すべてのエッジ トランスポート サーバーでネットワーク トラフィックが負荷分散されるようにすることができます。ラウンド ロビンとは、DNS サーバーがネットワーク リソースを共有して負荷を分散するために使用するシンプルなメカニズムです。

すべてのエッジ トランスポート サーバーで同じ構成情報が使用されるようにするには、提供されている複製構成スクリプトを使用して、ソース サーバーの構成をターゲット サーバーに複製します。

構成済みのソース サーバーに基づいて新しいエッジ トランスポート サーバーを展開するには、*複製構成*を使用します。この場合、ソース サーバー構成情報が複製されてから、XML ファイルにエクスポートされます。次に、この XML ファイルが移動先サーバーにインポートされます。

ここでは、複製構成プロセスの概要について説明します。複製構成を使用したエッジ トランスポート サーバーの構成の詳細な手順については、「[複製構成を使用してエッジ トランスポート サーバーを構成する](configure-edge-transport-server-using-cloned-configuration-exchange-2013-help.md)」を参照してください。

**目次**

複製構成と EdgeSync

複製構成プロセス

トランスポート構成情報

## 複製構成と EdgeSync

複製構成をインポートした後で、EdgeSync プロセスを実行します。受信者の参照やメッセージ セキュリティ タスクを実行するには、エッジ トランスポート サーバーに、Active Directory に格納されているデータが必要になります。*EdgeSync* とは、Exchange 2013 メールボックス サーバーで実行される一連のプロセスのことです。これらのプロセスによって、Active Directory からエッジ トランスポート サーバー上の AD LDS インスタンスへの一方向で、受信者情報と構成情報がレプリケートされます。EdgeSync がコピーするのは、エッジ トランスポート サーバーがスパム対策タスクを実行するために必要な情報、およびエンド ツー エンドのメール フローを有効にするために必要なコネクタ構成に関する情報だけです。EdgeSync は、AD LDS の情報が最新の状態に維持されるように、スケジュールされた更新を実行します。

複製構成では、サーバーのエッジ サブスクリプション設定は複製されません。EdgeSync で使用する証明書も複製されません。エッジ トランスポート サーバーごとに、EdgeSync プロセスを別々に実行する必要があります。EdgeSync は、複製構成情報と EdgeSync レプリケーション情報の両方に含まれている設定をすべて上書きします。これらの設定には、送信コネクタ、受信コネクタ、承認済みドメイン、およびリモート ドメインがあります。

## 複製構成プロセス

複製構成プロセスは 3 つの手順から構成されます。

1.  ソース サーバーから構成をエクスポートします。
    
    ExportEdgeConfig.ps1 スクリプト (%ExchangeInstallPath%Scripts にあります) を実行して、ソース サーバーの構成情報を中間 XML ファイルにエクスポートします。

2.  移動先サーバーの構成を検証します。
    
    ImportEdgeConfig.ps1 スクリプト (%ExchangeInstallPath%Scripts にあります) を実行します。このスクリプトは、中間 XML ファイル内の既存の情報を調べて、エクスポートされた設定がターゲット サーバーに対して有効かどうかを確認し、応答ファイルを作成します。この応答ファイルは、ターゲット サーバーへの構成のインポート時に使用される、サーバー固有の情報を指定します。応答ファイルには、移動先サーバーに対して有効ではない移動元サーバーの各設定のエントリが含まれています。移動先サーバーに対して有効になるようにこれらの設定を変更することができます。すべての設定が有効な場合は、応答ファイルにエントリは存在しません。

3.  移動先サーバーで構成をインポートします。
    
    ImportEdgeConfig.ps1 スクリプトは、中間 XML ファイルと応答ファイルを使用して、既存の構成をサーバーに複製するか、あるいはサーバーを特定の構成に復元します。

## 手順 1:ソース サーバーから構成をエクスポートする

エッジ トランスポート サーバーの役割をインストールして構成した後、ExportEdgeConfig.ps1 スクリプト (%ExchangeInsallPath%Scripts にあります) を実行します。このスクリプトは移動元サーバーの構成情報を取得し、その情報を中間 XML ファイルに格納します。

次の情報が移動元サーバーからエクスポートされ、中間 XML ファイルに格納されます。

  - トランスポート サービス関連の情報とログ ファイル パス情報:
    
      - *ReceiveProtocolLogPath*
    
      - *SendProtocolLogPath*
    
      - *MessageTrackingLogPath*
    
      - *PickupDirectoryPath*
    
      - *RoutingTableLogPath*

  - 各トランスポート エージェントの状態および優先度設定などのトランスポート エージェント関連の情報。

  - すべての送信コネクタ関連の情報。いずれかの送信コネクタが資格情報を使用するように構成されている場合、パスワードは、暗号化された文字列として中間の XML ファイルに書き込まれます。ImportEdgeConfig.ps1 および ExportEdgeConfig.ps1 スクリプトで *-key* パラメーターを使用して、パスワードの暗号化と解読に使用する 32 バイトの文字列を指定できます。*-key* パラメーターを使用しない場合は、既定の暗号化キーが使用されます。

  - 受信コネクタ関連の情報。ローカル ネットワークのバインドおよびポートのプロパティを変更するには、構成の検証手順で作成される応答ファイルの構成情報を変更する必要があります。

  - 承認済みドメインの構成。

  - リモート ドメインの構成。

  - スパム対策機能の構成設定:
    
      - IP 許可一覧の情報。管理者が手動で構成した IP 許可一覧のエントリのみがエクスポートされます。
    
      - IP 禁止一覧の情報。
    
      - コンテンツ フィルターの構成。
    
      - 受信者フィルターの構成。
    
      - アドレス書き換えエントリ。
    
      - 添付ファイル フィルター エントリ。

ページのトップへ

## 手順 2:ターゲット サーバーの構成を検証する

ターゲット サーバーは、エッジ トランスポート サーバーの役割がクリーン インストールされている Exchange 2013 サーバーです。最初に、ターゲット サーバーで ImportEdgeConfig.ps1 スクリプト (%ExchangeInsallPath%Scripts にあります) を実行して、中間 XML ファイルの既存の情報を検証し、応答ファイルを作成します。この応答ファイルは、ターゲット サーバーへの構成のインポート時に使用される、サーバー固有の情報を指定します。応答ファイルには、移動先サーバーに対して有効ではない移動元サーバーの各設定のエントリが含まれています。ターゲット サーバーに有効な設定になるように、これらの設定を変更する必要があります。すべての設定が有効な場合は、応答ファイルにエントリは存在しません。中間 XML ファイルは、複数の異なる移動先サーバーに対して使用できます。応答ファイルは特定の移動先サーバーに固有です。

ImportEdgeConfig.ps1 スクリプト (%ExchangeInsallPath%Scripts にあります) は、以下のタスクを実行します。

  - ターゲット サーバーでデータ パスとログ パスを作成できることを確認します。パスを作成できない場合は、空白のパスが応答ファイルに挿入されます。

  - XML ファイル内の送信コネクタごとに、送信元 IP アドレス用の空白のエントリを応答ファイルに追加します。

  - XML ファイル内の受信コネクタごとに、ローカル ネットワーク バインド用の空白のエントリを応答ファイルに追加します。

サーバー固有の設定に関する以下の情報を指定するには、応答ファイルを手動で変更する必要があります。

  - データ パスとログ パスを指定します。これらのパスが応答ファイルで空白のままになっている場合は、ターゲット サーバーに構成をインポートする次の手順で、中間 XML ファイルで構成されるパスが使用されます。

  - 送信コネクタ エントリごとに、送信元 IP アドレスを指定します。このフィールドが空白のままになっている場合は、構成のインポート手順でエラーが発生します。

  - 受信コネクタ エントリごとに、ローカル ネットワーク バインドを指定します。ローカル ネットワーク バインドが空白のままになっている場合は、ターゲット サーバーに構成をインポートする際にエラーが発生します。

ページのトップへ

## 手順 3:ターゲット サーバーに構成をインポートする

すべてのターゲット サーバーでこの手順を実行して、既存のエッジ トランスポート サーバーの構成を複製するか、サーバーを特定の構成に復元します。ImportEdgeConfig.ps1 スクリプト (%ExchangeInsallPath%Scripts にあります) を実行して、新しい構成を検証してインポートします。このスクリプトを実行すると、ターゲット サーバーの構成が、中間 XML ファイルおよび応答ファイルの設定と同じになります。


> [!IMPORTANT]
> 複製操作が失敗した場合、サーバーを以前の安定した状態に復元できるように、構成のインポート プロセスを実行する前に、既存のサーバー構成をバックアップすることをお勧めします。



この手順では、応答ファイルで提供されるサーバー固有の情報を使用します。応答ファイルで設定が指定されていない場合は、中間 XML ファイルのデータが使用されます。スクリプトは、構成を変更する前に、中間 XML ファイルおよび応答ファイルのデータを検証します。

構成をインポートすると、ターゲット サーバー構成の以下の設定が変更されます。

  - トランスポート エージェントの構成が変更されます。

  - ターゲット サーバーの既存のコネクタが削除され、中間 XML ファイルに含まれるコネクタが追加されます。

  - 既存の承認済みドメインが削除され、中間 XML ファイル内の承認済みドメイン エントリが追加されます。

  - 既存のリモート ドメインが削除され、中間 XML ファイル内のリモート ドメイン エントリが追加されます。

  - 既存の IP 許可一覧のエントリが削除され、中間リモート ドメイン ファイル内の IP 許可一覧のエントリが追加されます。

  - 既存の IP 禁止一覧のエントリが削除され、中間リモート ドメイン ファイル内の IP 禁止一覧のエントリが追加されます。

  - 次のスパム対策構成が対象のサーバーに複製されます。
    
      - コンテンツ フィルターの構成
    
      - 受信者フィルターの構成
    
      - アドレス書き換えエントリ
    
      - 添付ファイル フィルター エントリ

ページのトップへ

## トランスポート構成情報

トランスポート構成オブジェクトの設定によって、エッジ トランスポート サーバーのサーバー全体の電子メール トランスポート設定が定義されます。中間 XML ファイルをターゲット サーバーにインポートすると、以下の設定を除く、トランスポート構成オブジェクトのすべての設定がインポートされます。

  - エクスポートされた XML ファイルに含まれる一般名および作成日時

  - 送信コネクタ情報

  - 受信コネクタ情報

  - 添付ファイル フィルター エントリ

  - **MaxDumpsterSizePerStorageGroup** 属性エントリ

インポート処理の完了後は、必要に応じて **Set-TransportConfig** コマンドレットを使用して設定を構成できます。詳細については、「[Set-TransportConfig](https://technet.microsoft.com/ja-jp/library/bb124151\(v=exchg.150\))」を参照してください。

以下の表にリストする属性には、トランスポート構成オブジェクトおよび既定値が関連付けられます。このオブジェクトは、メールボックス サーバーとエッジ トランスポート サーバーの両方で構成できます。ただし、多くの属性は、Exchange 2013 メールボックス サーバー上のトランスポート サービスにのみ適用されます。これらの属性をエッジ トランスポート サーバーで構成しても、効果はありません。

### トランスポート構成の属性と既定値

<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>属性</th>
<th>説明</th>
<th>既定値</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>ClearCategories</strong></p></td>
<td><p>この属性は、コンテンツの変換時に Microsoft Outlook の分類を消去するかどうかを指定します。</p></td>
<td><p>True</p></td>
</tr>
<tr class="even">
<td><p><strong>GenerateCopyOfDSNFor</strong></p></td>
<td><p>この属性は、配信状態通知 (DSN) コードを指定します。これによって、DSN メッセージがポストマスターの電子メール アドレスにコピーされます。DSN コードは、<em>x.y.z</em> の形式で入力され、コンマで区切られます。</p></td>
<td><p>5.4.8, 5.4.6, 5.4.4, 5.2.4, 5.2.0, 5.1.4</p></td>
</tr>
<tr class="odd">
<td><p><strong>InternalSMTPServers</strong></p></td>
<td><p>この属性には、Sender ID および接続フィルターによって無視される必要のある、内部 SMTP サーバーの IP アドレスまたは IP アドレスの範囲の一覧を指定します。</p></td>
<td><p>NULL</p></td>
</tr>
<tr class="even">
<td><p><strong>JournalingReportNdrTo</strong></p></td>
<td><p>この属性は、ジャーナリング メールボックスが利用できない場合に、ジャーナル レポートの送信先となる電子メール アドレスを指定します。この属性は、エッジ トランスポート サーバーの構成には適用されません。</p></td>
<td><p>NULL</p></td>
</tr>
<tr class="odd">
<td><p><strong>MaxDumpsterSizePerStorageGroup</strong></p></td>
<td><p>この属性は、メールボックス サーバー上のトランスポート収集の最大サイズを指定します。この属性は、エッジ トランスポート サーバーの構成には適用されません。</p></td>
<td><p>18 MB</p></td>
</tr>
<tr class="even">
<td><p><strong>MaxDumpsterTime</strong></p></td>
<td><p>この属性は、メールボックス サーバー上のトランスポート収集に電子メール メッセージを保存する期間を指定します。この属性は、エッジ トランスポート サーバーの構成には適用されません。</p></td>
<td><p>7.00:00:00</p></td>
</tr>
<tr class="odd">
<td><p><strong>MaxReceiveSize</strong></p></td>
<td><p>この属性は、組織内の受信者が受信できる最大メッセージ サイズを指定します。この属性は、エッジ トランスポート サーバーの構成には適用されません。</p></td>
<td><p>10 MB</p></td>
</tr>
<tr class="even">
<td><p><strong>MaxRecipientEnvelopeLimit</strong></p></td>
<td><p>この属性は、単一の電子メール メッセージで許可される最大受信者数を指定します。この属性は、エッジ トランスポート サーバーの構成には適用されません。</p></td>
<td><p>5,000</p></td>
</tr>
<tr class="odd">
<td><p><strong>MaxSendSize</strong></p></td>
<td><p>この属性は、組織内の送信者が送信できる最大メッセージ サイズを指定します。この属性は、エッジ トランスポート サーバーの構成には適用されません。</p></td>
<td><p>10 MB</p></td>
</tr>
<tr class="even">
<td><p><strong>TLSReceiveDomainSecureList</strong></p></td>
<td><p>この属性は、ドメイン セキュリティをサポートするように構成された受信コネクタを通じて相互トランスポート層セキュリティ (TLS) 認証を使用するリモート ドメインを指定します。複数のドメインを指定する場合は、コンマで区切ります。ワイルドカード文字 (*) は、この属性の一覧にあるドメインではサポートされていません。</p></td>
<td><p>NULL</p></td>
</tr>
<tr class="odd">
<td><p><strong>TLSSendDomainSecureList</strong></p></td>
<td><p>この属性は、ドメイン セキュリティと対象のドメインのアドレス スペースをサポートするよう構成されている送信コネクタを通じて電子メールが送信される場合に相互 TLS 認証を使用するリモート ドメインを指定します。複数のドメインを指定する場合は、コンマで区切ります。ワイルドカード文字 (*) は、この属性の一覧にあるドメインではサポートされていません。</p></td>
<td><p>NULL</p></td>
</tr>
<tr class="even">
<td><p><strong>VerifySecureSubmitEnabled</strong></p></td>
<td><p>この属性は、メールボックス サーバーのメールボックスからメッセージを送信している電子メール クライアントが、暗号化された MAPI 発信を使用しているかどうかを確認します。この属性は、エッジ トランスポート サーバーの構成には適用されません。この属性の有効な値は、<code>$true</code> または <code>$false</code> です。</p></td>
<td><p>False</p></td>
</tr>
<tr class="odd">
<td><p><strong>VoicemailJournalingEnabled</strong></p></td>
<td><p>この属性は、ユニファイド メッセージング ボイス メールをジャーナリング エージェントでジャーナル処理するかどうかを指定します。この属性は、エッジ トランスポート サーバーの構成には適用されません。</p></td>
<td><p>True</p></td>
</tr>
</tbody>
</table>



> [!NOTE]
> 後からエッジ トランスポート サーバーを Exchange 組織にサブスクライブすると、<STRONG>InternalSMTPServers</STRONG> 属性の値が EdgeSync プロセス中に上書きされます。詳細については、「<A href="edge-subscriptions-exchange-2013-help.md">エッジ サブスクリプション</A>」を参照してください。



ページのトップへ

