---
title: 'DNS クエリ エラーの感度: Exchange 2013 Help'
TOCTitle: DNS クエリ エラーの感度
ms:assetid: a3c3980c-20ca-4b54-a2e6-76d49af620b4
ms:mtpsurl: https://technet.microsoft.com/ja-jp/library/Bb676467(v=EXCHG.150)
ms:contentKeyID: 52057842
ms.date: 04/24/2018
mtps_version: v=EXCHG.150
ms.translationtype: HT
---

# DNS クエリ エラーの感度

 

_**適用先:** Exchange Server 2013_

_**トピックの最終更新日:** 2014-12-02_

送信先ドメインで DNS エラーが発生する場合、Microsoft Exchange Server 2013 では、DNS クエリの感度を調整してメッセージ配信の速度を少し上げます。ただし、DNS エラーによっては、この調整を行うと、特定の状況で配信エラーが発生する可能性があります。

## DNS クエリおよびリモート メッセージ配信

外部の受信者にメッセージを配信する Exchange サーバーは、外部の受信者へのメールを受け取る送信先のメッセージング サーバーを検出できる必要があります。送信先に応じて、メッセージは 1 つ以上のリモート配信キュー内に保存され、リモート受信者に配信されるまで待機します。配信キューの詳細については、「[キュー](queues-exchange-2013-help.md)」を参照してください。

Exchange サーバーは、構成されている DNS サーバーに対してクエリを実行して、メッセージを配信するのに必要な DNS レコードを見つけます。記載されている順序で DNS サーバーの照会が行われます。いずれかの DNS サーバーが使用できない場合は、一覧の次の DNS サーバーに対してクエリが実行されます。DNS サーバーに対して、次の情報のクエリが実行されます。

  - **外部受信者のドメイン部分の Mail Exchange (MX) レコード**   MX レコードには、ドメイン宛てのメッセージを受け付けるメッセージング サーバーの完全修飾ドメイン名 (FQDN) と、そのメッセージング サーバーの preference の値が含まれています。preference の値が小さいほど優先度の高いメッセージング サーバーであることを示します。ドメインに複数の MX レコードがある場合は、preference の値が重要です。フォールト トレランスを最適化するために、大部分の組織では、複数のメッセージング サーバーと、preference の値が異なる複数の MX レコードを使用します。

  - **送信先メッセージング サーバーの A (アドレス) レコード**   MX レコード内で使用されているすべてのメッセージング サーバーには、対応する A レコードが必要です。A レコードは、送信先メッセージング サーバーの IP アドレスを見つけるのに使用されます。購読されているエッジ トランスポート サーバーは、その IP アドレスを使用して、送信先メッセージング サーバーとの SMTP 接続を行います。MX レコード内の正規名 (CNAME) レコードの FQDN を使用することも技術的には可能ですが、この手法は RFC 974、RFC 1034、RFC 1912、および RFC 2181 に違反するので、大部分のメッセージング サーバーではサポートされていません。
    
    ルート DNS サーバーから始まる反復的な DNS クエリと再帰的な DNS クエリの組み合わせは、MX レコード内で見つかったメッセージング サーバーの FQDN を IP アドレスに解決するために使用されます。

Exchange 2013 では、各 DNS サーバーに対する構成不可能な DNS クエリの制限 (5 秒間) と、DNS クエリ全体に対する制限 (1 分間) があります。

## DNS に関する潜在的な問題

Exchange サーバーで DNS の設定が適切に構成されている場合も、特定のドメインの DNS レコードに関する問題や、特定のドメインの権限のある DNS サーバーを見つけるために使用される任意の DNS サーバーに関する問題が発生する可能性は残っています。通常、こうした問題はユーザー側で解決できないため、DNS サーバーの所有者が解決する必要があります。このような DNS 関連のエラーは、次の状況の 1 つ以上が原因と考えられます。

  - 送信先ドメインの DNS レコードが無効な場合

  - DNS サーバーの使用率に問題がある場合

  - DNS サーバーのレプリケーションに問題がある場合

Exchange 2013 では、DNS クエリがエラーになると、次の DNS サーバーが現在のクエリに対して既にエラーを返していない場合にのみ、次の DNS サーバーに対してクエリが続行されます。

`%ExchangeInstallPath%bin\EdgeTransport.exe.config` XML アプリケーション構成ファイルを変更することによって DNS クエリ エラーの感度を制御することができます。このファイルは、Microsoft Exchange Transport サービスに関連付けられています。このファイルに保存した変更は、Microsoft Exchange Transport サービスの再起動後に適用されます。このサービスを再起動すると、サーバー上のメール フローは一時的に中断されます。DNS クエリ エラーの感度は、EdgeTransport.exe.config ファイルの *DnsFaultTolerance* キーによって制御されます。このキーでは次の値を使用します。

  - **Lenient**   DNS クエリが有効な MX レコードと無効な MX レコードの組み合わせを検出した場合、DNS クエリのタイムアウト値である 1 分に達するまで DNS クエリを続行します。無効な MX レコードは破棄され、最も小さい preference 値を持つ有効な MX レコードが送信先メッセージング サーバーにメッセージを配信するのに使用されます。これは既定の値です。

  - **Normal**   DNS クエリが最初に無効な MX レコードを検出すると、無効な MX レコードと同じまたはそれより大きい preference 値を持つ解決された MX レコードは、直ちに破棄されます。DNS クエリ全体のタイムアウトを待機せずに、最も小さい preference 値を持つ残りの MX レコードが、送信先メッセージング サーバーにメッセージを配信するのに使用されます。この動作によってメッセージ配信の速度が上がる可能性がありますが、次の条件が当てはまる場合、DNS クエリが有効な MX レコードを持たないという欠点があります。
    
      - 無効な MX レコードが、送信先ドメインの最初の MX レコードである場合。
    
      - 有効な MX レコードが、無効な MX レコードと同じ precedence 値を持つ場合。

`Normal` モードと `Lenient` モードのどちらでも、無効な MX レコードに対する DNS クエリの結果はキャッシュされません。DNS クエリの次回実行時に、送信先ドメインの MX レコードの解決を試みます。


> [!NOTE]
> Exchange XML アプリケーション構成ファイルで行うカスタマイズ済みのサーバーごとの設定 (クライアント アクセス サーバーの web.config ファイルまたはメールボックス サーバーの EdgeTransport.exe.config ファイルなど) は、Exchange 累積更新プログラム (CU) のインストール時に上書きされます。インストール後にサーバーを簡単に再構成できるよう、必ずこの情報を保存しておいてください。これらの設定は、Exchange 累積更新プログラムのインストール後に構成し直す必要があります。


