---
title: 'コンテンツ変換トレース: Exchange 2013 Help'
TOCTitle: コンテンツ変換トレース
ms:assetid: eb9c7df2-9093-49f9-aa4f-044909bd2225
ms:mtpsurl: https://technet.microsoft.com/ja-jp/library/Bb397226(v=EXCHG.150)
ms:contentKeyID: 49896538
ms.date: 04/24/2018
mtps_version: v=EXCHG.150
ms.translationtype: HT
---

# コンテンツ変換トレース

 

_**適用先:** Exchange Server 2013_

_**トピックの最終更新日:** 2012-09-25_

コンテンツ変換トレースでは、Microsoft Exchange Server 2013 メールボックス サーバーを実行しているコンピューター上で、受信および送信メッセージに対してメールボックス トランスポート サービスによって実行される MAPI コンテンツ変換のエラーがキャプチャされます。

メールボックス サーバー上のメールボックス トランスポート サービスは、メールボックス受信者との間で送受信されるメッセージのコンテンツ変換を行います。 特にメールボックス トランスポート発信サービスは、メールボックス ユーザーからの送信メッセージを MAPI から MIME に変換します。 メールボックス トランスポート配信サービスは、メールボックス ユーザーの受信メッセージを MIME から MAPI に変換します。 コンテンツ変換トレースは、これらの MAPI 変換エラーをキャプチャします。

メールボックス サーバー上のトランスポート サービスのカテゴライザーは、外部の受信者に送信されるすべてのメッセージのコンテンツ変換を行います。 コンテンツ変換トレースは、外部の受信者に送信されたメッセージを変換する際に、トランスポート サービスのカテゴライザーが検出したコンテンツ変換エラーはキャプチャしません。

**目次**

コンテンツ変換トレースの構成

コンテンツ変換トレースの動作方法

コンテンツ変換トレースについての考慮事項

## コンテンツ変換トレースの構成

コンテンツ変換トレースは、Exchange 管理シェル内の **Set-TransportService** および **Set-MailboxTransportService** コマンドレットの次のパラメーターで制御されます。

  - *ContentConversionTracingEnabled*   このパラメーターは、メールボックス サーバー上のトランスポート サービスまたはメールボックス トランスポート サービスのコンテンツ変換トレースを有効または無効にします。このパラメーターの有効な値は、`$true` および `$false` です。既定値は `$false` です。 ユーザーの Exchange 組織に複数のメールボックス サーバーがある場合、各メールボックス サーバーでコンテンツ変換トレースを有効にする必要があります。

  - *PipelineTracingPath*   このパラメーターはパイプライン トレースと関連付けられますが、コンテンツ変換トレース ファイルのルートの場所も指定します。既定では、トランスポート サービスは `%ExchangeInstallPath%TransportRoles\Logs\Hub\PipelineTracing` にあります。 規定では、メールボックス トランスポート サービスは、`%ExchangeInstallPath%TransportRoles\Logs\Mailbox\PipelineTracing` にあり、パスは Exchange コンピューターに対してローカルである必要があります。

コンテンツ変換では、*PipelineTracingPath* パラメーターで指定されたパス内に `ContentConversionTracing` という名前のフォルダーが作成されます。`ContentConversionTracing` フォルダー内には、コンテンツ変換によって、次の 2 つのサブフォルダーが作成されます。「`InboundFailures`」および「`OutboundFailures`」。 `InboundFailures` フォルダーには、受信メッセージのコンテンツ変換エラーに関する情報が格納されます。 `OutboundFailures` フォルダーには、送信メッセージのコンテンツ変換エラーに関する情報が格納されます。

`InboundFailures` フォルダーまたは `OutboundFailures` フォルダー内の全ファイルの最大サイズは 128 MB です。 コンテンツ変換トレースでは、ファイルの保存期間またはサイズを基準にして、循環ログを使用して古いファイルを削除することはありません。 フォルダーの最大サイズに達するとすぐに、コンテンツ変換トレースでは、フォルダーへの情報の書き込みを停止します。 フォルダーの最大サイズ制限を超えないようにする場合、コンテンツ変換トレース ファイルを別の場所に定期的に移動するスケジュール タスクを作成できます。

コンテンツ変換トレースで使用されるフォルダーとサブフォルダーに必要なアクセス許可は、次のとおりです。

  - 管理者 : フル コントロール

  - ネットワーク サービス : フル コントロール

  - システム : フル コントロール


> [!NOTE]
> コンテンツ変換トレースは、電子メール メッセージのコンテンツを完全にコピーします。 機密情報の不要な公開を防ぐには、コンテンツ変換トレース ファイルの場所に対して、適切なセキュリティのアクセス許可を設定する必要があります。



ページのトップへ

## コンテンツ変換トレースの動作方法

受信メッセージのコンテンツ変換が失敗すると、状態コードが 5.6.0 の配信状態通知 (DSN) がメッセージの送信者に送信されます。 コンテンツ変換トレースが有効な場合、5.6.0 DSN メッセージの生成時に、エラー情報が記録されます。 コンテンツ変換エラーごとに、2 つの異なるファイルが生成されます。

受信メッセージの MIME から MAPI への変換時にコンテンツ変換エラーが発生すると、InboundFailures フォルダーに次の 2 つのファイルが生成されます。

  - **\<GUID\>.eml**   このファイルには、テキスト形式のエラー メッセージが含まれています。

  - **\<GUID\>.txt**   このファイルには、例外の説明、変換結果、変換オプション、およびメールボックス トランスポート サービスによってすべてのメッセージに課されるメッセージ サイズの制限が含まれています。

送信メッセージの MAPI から MIME への変換時にコンテンツ変換エラーが発生すると、OutboundFailures フォルダーに次の 2 つのファイルが生成されます。

  - **\<GUID\>.msg**   このファイルには、Microsoft Outlook メッセージ形式のエラー メッセージが含まれています。

  - **\<GUID\>.txt**   このファイルには、例外の説明、変換結果、変換オプション、およびストア ドライバーによってすべてのメッセージに課されるメッセージ サイズの制限が含まれています。

プレースホルダー \<*GUID*\> は、どちらのファイル名でも同じです。 コンテンツ変換エラーごとに、対応するメッセージとテキスト ファイルのファイル名に使用される異なる GUID が生成されます。 ファイル名に使用される GUID の例としては、`038b930e-61fd-4bfd-b9b4-0374c18b73f7` が挙げられます。

ページのトップへ

## コンテンツ変換トレースについての考慮事項

予防的監視のためにコンテンツ変換トレースを有効にしたままにできます。 または、コンテンツ変換トレースを有効にして、特定のエラー イベントをトラブルシューティングできます。 受信コンテンツ変換エラーを再現するには、通常 5.6.0 DSN メッセージの受信者に元のメッセージを再送信してもらいます。

受信コンテンツ変換エラーは、最も一般的なエラーです。 受信コンテンツ変換エラーの原因には、次のようなものがあります。

  - **メッセージ サイズ制限の違反**   これらのメッセージ サイズの制限は、サービス拒否攻撃 (DoS) を防止するために、メールボックス トランスポート サービスによって課されます。 これらのメッセージ制限については、\<*GUID*\>.txt ファイルに一覧表示されています。 これらのメッセージ制限には、以下のものが含まれます。
    
      - **MaxMimeTextHeaderLength**   この制限は、MIME ヘッダーに使用できるテキストの最大文字数を指定します。 値は 2000 です。
    
      - **MaxMimeSubjectLength**   この制限は、件名行に使用できるテキストの最大文字数を指定します。 値は 255 です。
    
      - **MSize**   この制限は、メッセージの最大サイズを指定します。 値は 2147483647 バイトです。
    
      - **MaxMimeRecipients**   この制限は、"宛先"、"CC"、および "BCC" フィールドに許可される受信者の総数を指定します。 値は 12288 です。
    
      - **MaxRecipientPropertyLength**   この制限は、受信者説明に使用できるテキストの最大文字数を指定します。 値は 1000 です。
    
      - **MaxBodyPartsTotal**   この制限は、MIME マルチパート メッセージに使用できるメッセージ パーツの最大数を指定します。 値は 250 です。
    
      - **MaxEmbeddedMessageDepth**   この制限は、メッセージ内に存在可能な転送されたメッセージの最大数を指定します。 値は 30 です。
    
    メールボックス サーバー上のトランスポート サービスまたはエッジ トランスポート サーバーで使用される構成可能なメッセージ サイズの制限の詳細については、「[メッセージ サイズの制限](message-size-limits-exchange-2013-help.md)」を参照してください。

  - **iCalendar 受信メッセージから会議出席依頼への変換エラー**   RFC 2445 では、iCalendar を予定表データ交換の標準として定義しています。 変換エラーの具体的な原因には、次のようなものがあります。
    
      - 送信エージェントによる iCalendar の誤使用。
    
      - Outlook または Exchange 予定表スキーマでサポートできない iCalendar の構成要素。
    
    iCalendar で変換エラーが発生しても、送信者に 5.6.0 DSN メッセージは送信されません。 代わりに、iCalendar メッセージ本文を含む .ics 添付ファイルでメッセージが配信されます。

  - **誤った形式の MIME メッセージによるエラー**   迷惑な商用電子メールまたはスパム メッセージのメッセージ ヘッダーには、受信者説明内の引用符の不一致など、形式のエラーがある可能性があります。 誤った形式の MIME メッセージによるかなり少数のエラーはバグと考えられます。

送信コンテンツ変換エラーは、受信エラーに比べてさほど一般的ではありません。 送信エラーが発生した場合、その原因は通常、Exchange コードのバグまたはメッセージ コンテンツの破損です。

ページのトップへ

