---
title: '負荷分散: Exchange 2013 Help'
TOCTitle: 負荷分散
ms:assetid: f572c193-6f3a-400e-9085-a9d3e5e18c59
ms:mtpsurl: https://technet.microsoft.com/ja-jp/library/JJ898588(v=EXCHG.150)
ms:contentKeyID: 51407603
ms.date: 04/24/2018
mtps_version: v=EXCHG.150
ms.translationtype: HT
---

# 負荷分散

 

_**適用先:**Exchange Server 2013_

_**トピックの最終更新日:**2016-12-09_

負荷分散は、サーバーによるトラフィックの受信を管理するための方法です。負荷分散は、受信クライアント接続をさまざまなエンドポイント (クライアント アクセス サーバーなど) に分散し、1 つのエンドポイントが負荷を過剰に負担することがないようにするうえで役に立ちます。また、負荷分散は 1 つ以上のエンドポイントで障害が発生した場合に、フェールオーバーの冗長性も提供できます。Exchange Server 2013 で負荷分散を行うことで、コンピューターの障害時にもユーザーが継続して Exchange サービスを利用できるようにします。また、負荷分散により、クライアントには単一のホスト名を提供しつつ、展開において 1 台のサーバーが処理可能な量を超えるトラフィックを処理できるようにもなります。

負荷分散には 2 つの主な目的があります。これにより、Active Directory サイトのうちの 1 箇所における単一のクライアント アクセス サーバー障害による影響を軽減します。さらに、負荷分散は、各クライアント アクセス サーバーの負荷が均等に分散されるようにします。

Exchange 2013 には、スイッチオーバーとフェールオーバーの冗長性を実現する以下のソリューションも含まれています。

  - **高可用性**Exchange 2013 は、データベース可用性グループ (DAG) を使用して、同期された異なるサーバー上にメールボックスの複数のコピーを保持します。これにより、1 つのサーバー上のメールボックス データベースに障害が発生した場合に、ユーザーは別のサーバー上の同期されたデータベースのコピーに接続できます。

  - **サイトの復元** 2 つの Active Directory サイトを地理的に個別の場所に展開して、2 つの間で同期されたメールボックス データを保持し、一方で障害が生じた場合に、もう一方に負荷全体を処理させることができます。

  - **メールボックスのオンライン移動** メールボックスのオンライン移動では、移動中もユーザーは自分の電子メール アカウントにアクセスできます。ユーザーがロックアウトされるのは、処理の最後の短い間 (最終的な同期が行われている間) だけです。メールボックスのオンライン移動は、フォレスト間または同じフォレスト内で実行できます。

  - **シャドウ冗長**   シャドウ冗長は、メッセージの送信中における可用性と回復性を保護します。シャドウ冗長を使用することで、トランスポート サーバーがメッセージのすべてのネクスト ホップが完了したことを確認するまで、トランスポート データベースのメッセージの削除は遅延されます。ネクスト ホップのいずれかに失敗して、配信が正常に行われたことを示すレポートが届かなかった場合は、完了しなかったホップに配信されるようにメッセージが再送信されます。

## Exchange Server 2013 の負荷分散のアーキテクチャ上の変更

Exchange Server 2010 では、クライアントの接続および処理が、クライアント アクセス サーバーの役割によって行われていました。これには、外部と内部両方の Outlook 接続、モバイル デバイス接続、およびサード パーティ クライアント接続の負荷を、展開内の一連のクライアント アクセス サーバーに分散し、サーバーのフォールト トレランスと効率的な使用を実現する必要がありました。多数の Exchange 2010 クライアント アクセス プロトコルにアフィニティ、つまり、クライアントと特定のクライアント アクセス サーバー間の関係が必要でした。特に、Outlook Web App、Exchange コントロール パネル、Exchange Web サービス、Outlook Anywhere、Outlook TCP/IP MAPI 接続、Exchange ActiveSync、Exchange アドレス帳サービス、およびリモート PowerShell は、クライアントとクライアント アクセス サーバー間のアフィニティが必須であるか、またはそれによってメリットがもたらされていました。Exchange 2010 の負荷分散のオプションには以下が含まれていました。

  - ソース IP アフィニティ による Windows ネットワーク負荷分散

  - ハードウェアによる負荷分散

Exchange 2010 のクライアント プロトコルにはさまざまなニーズがあるため、レイヤー 7 負荷分散ソリューションを使用することを推奨していました。クライアントとサーバー間のやり取り全体をロード バランサー ロジックで使用できる場合は、レイヤー 7 (アプリケーションレベル負荷分散とも呼ばれる) によって、負荷分散ソリューションは複雑なルールを使用してシステムに送られる各要求のバランスを取る方法を決定できます。これらの複雑なルールにより、特定のクライアントからのすべての要求が同じクライアント アクセス サーバーのエンドポイントに渡されるようになっていました。Exchange 2010 では、特定のクライアントからのすべての要求がアフィニティを必要とするプロトコルの同じエンドポイントに渡されなかった場合、ユーザー エクスペリエンスにマイナスの影響が生じていました。Exchange 2010 負荷分散オプションの詳細については、「[Exchange 2010 の負荷分散について](https://go.microsoft.com/fwlink/p/?linkid=196447)」を参照してください。

Exchange Server 2013 では、クライアント アクセス サーバーとメールボックス サーバーという、主に 2 つのサーバーの種類があります。Exchange 2013 のクライアント アクセス サーバーは、軽量なステートレス プロキシ サーバーとして動作し、クライアントが Exchange 2013 メールボックス サーバーに接続できるようにします。Exchange 2013 クライアント アクセス サーバーは、統一された名前空間と認証を提供します。さらに、Exchange 2013 クライアント アクセス サーバーは次の特長を備えています。

  - クライアント プロトコルのプロキシおよびリダイレクトのロジックをサポートします。

  - レイヤー 4 負荷分散の使用をサポートします。

セッション アフィニティとレイヤー 7 負荷分散により、各種プロトコルのニーズに応じて、クライアントとサーバー間のすべての要求が同じエンドポイントに送信されます。要求は、アプリケーション層で分散されます。レイヤー 4 負荷分散では、要求はトランスポート層で分散されます。負荷分散ソリューションは、(仮想 IP アドレスまたは VIP と呼ばれることもある) 単一の IP アドレス を認識しているクライアントからの要求を、操作を実行している一連のサーバーに分散します。クライアントとサーバー間の接続は必ず、要求の内容が決定される前に確立されるため、ロード バランサーは、要求の内容を調べる前に、要求を受信するサーバーを選択できます。ターゲット サーバーの選択は、受信接続ごとに循環リストの次のターゲット サーバーが選択される "ラウンドロビン" 方式や、ロード バランサーが新しい接続のぞれぞれをその時点で確立されている接続数が最小のサーバーに送信する "最小接続" 方式などのさまざまな方法で実行できます。現在、セッション アフィニティは不要なため、展開する負荷分散アーキテクチャの柔軟性と簡易性が高まり、選択の幅が広がります。セッション アフィニティなしの負荷分散により、Cookie ベースの負荷分散または Secure Sockets Layer (SSL) セッション ID などのより深く関連するアフィニティ オプションを維持するための処理が使用されないため、ロード バランサーの容量が増え、使用率が向上します。

## クライアント アクセス サーバー アレイと Exchange 2013

Exchange 2010 では、クライアント アクセス アレイの概念が導入されています。クライアント アクセス アレイが Active Directory サイト用に構成されると、サイト内のすべてのクライアント アクセス サーバーが自動的にそのアレイのメンバーになります。Exchange 2013 の現在のビルドでは、負荷分散された高可用性サービスの展開が非常に簡単に行えるようになったため、クライアント アクセス アレイの構成は不要です。

## 負荷分散ソリューション

ハードウェア ロード バランサーの使用は引き続き Exchange 2013 でもサポートされます。Exchange 2010 でのソリューション テストが完了し、Exchange 2013 でも正常に機能する可能性が高いハードウェア負荷分散ソリューションの詳細については、「[Exchange Server 2010 のロード バランサーの展開](https://go.microsoft.com/fwlink/p/?linkid=261834)」を参照してください。このページには、より複雑な、Exchange 2010 のハードウェア ロード バランサーのレイヤー 7 構成が示されていることに注意してください。Exchange 2013 トラフィックのロード バランスは、このトピックの前の部分で説明されたアーキテクチャ上の変更があるとすれば、より簡単なものとなります。Exchange プロトコルごとにセッション アフィニティを構成する代わりに、ロード バランサーによって、追加のアフィニティ処理を必要とすることなく、Exchange 2013 クライアント アクセス サーバーへの着信接続を使用可能なサーバーに宛先指定することができます。ハードウェア ロード バランサーは、特定のクライアント アクセス サーバーが使用不可能になり、受信接続を処理するサーバー セットから削除されたタイミングを検出できるため、Exchange サービスの高可用性を提供するうえで引き続き重要な役割を担っています。

## Windows ネットワーク負荷分散

Windows ネットワーク負荷分散 (WNLB) は、Exchange サーバーで使用される、最も一般的なソフトウェア ロード バランサーです。WNLB を Microsoft Exchange と共に展開することに関連して、制限事項がいくつかあります。

  - WNLB は Windows フェールオーバー クラスタリングと互換性がないため、メールボックス DAG も使用されている Exchange サーバー上では使用できません。Exchange 2013 DAG を現在使用していて WNLB を使用する場合は、クライアント アクセス サーバー役割とメールボックス サーバー役割を別のサーバー上で実行する必要があります。

  - WNLB はサービスの停止を検出しません。WNLB は IP アドレスでサーバーの停止を検出するだけです。これは、Outlook Web App のような特定の Web サービスでエラーが発生したにもかかわらず、サーバーが継続して機能していると、WNLB は障害を検出せず、引き続きクライアント アクセス サーバーに要求をルーティングすることを意味します。障害が発生しているクライアント アクセス サーバーは、負荷分散プールから取り除くために手動による介入が必要です。

  - WNLB を使用すると、ポート フラッディングが発生し、ネットワークに大きな負担を与える可能性があります。

  - WNLB は、送信元の IP アドレスを使用したクライアントのアフィニティのみを実行するため、送信元の IP プールが小さい場合には効率的なソリューションではありません。これは送信元の IP プールがリモート ネットワーク サブネットから来ている場合、または組織がネットワーク アドレス変換を使用している場合に起こります。

