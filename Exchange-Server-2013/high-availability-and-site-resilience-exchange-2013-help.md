---
title: '高可用性とサイトの復元: Exchange 2013 Help'
TOCTitle: 高可用性とサイトの復元
ms:assetid: 6628285e-d07c-443d-866b-be784ad1ed1e
ms:mtpsurl: https://technet.microsoft.com/ja-jp/library/Dd638137(v=EXCHG.150)
ms:contentKeyID: 48269595
ms.date: 04/24/2018
mtps_version: v=EXCHG.150
ms.translationtype: HT
---

# 高可用性とサイトの復元

 

_**適用先:** Exchange Server 2013_

_**トピックの最終更新日:** 2016-12-15_

高可用性およびサイトの復元に対応するようにメールボックス サーバーとデータベースを構成することで、Exchange Server 2013 メールボックス データベースおよびそれに含まれるデータを保護できます。Exchange 2013 は、より高レベルのサービスおよびデータの可用性を実現し、大容量のメールボックスをサポートすると同時に、可用性の高い復元メッセージング ソリューションの展開におけるコストと複雑さを軽減しています。

Exchange 2013 は、Exchange 2010 で導入されたネイティブ レプリケーション機能および高可用性アーキテクチャに基づき、あらゆる規模のお客様が、その所属部門を問わずに組織内のメッセージング継続性サービスを低コストで展開することを可能にします。Exchange 2010 および Exchange 2007 からの変更内容の一覧については、[以前のバージョンと比較した高可用性とサイト復元の変更点](changes-to-high-availability-and-site-resilience-over-previous-versions-exchange-2013-help.md)を参照してください。

**目次**

主要な関連用語

データベース可用性グループ

メールボックス データベース コピー

アクティブ マネージャー

サイトの復元

サードパーティ レプリケーション API

高可用性とサイトの復元のドキュメント

## 主要な関連用語

以下の主要な関連用語は、高可用性またはサイト復元を理解するうえで重要です。

  - *アクティブ マネージャー*  
    Exchange の内部コンポーネント。データベース可用性グループ (DAG) 内のフェールオーバーを通した障害の監視と修正措置を行う Microsoft Exchange レプリケーション サービスの内部で実行されます。

<!-- end list -->

  - *AutoDatabaseMountDial*  
    メールボックス サーバーのプロパティの設定。パッシブ データベース コピーが新しいアクティブ コピーとして自動的にマウントするかどうかを、マウントするコピーで不足しているログ ファイルの数に基づいて判断します。

<!-- end list -->

  - *連続レプリケーション - ブロック モード*  
    ブロック モードでは、各更新プログラムがアクティブ データベース コピーのアクティブ ログ バッファーに書き込まれる際に、ブロック モードの各パッシブ メールボックス コピーのログ バッファーにも配布されます。ログ バッファーがいっぱいになると、各データベース コピーは生成シーケンスにおける次のログ ファイルをビルドし、検査し、作成します。

<!-- end list -->

  - *連続レプリケーション - ファイル モード*  
    ファイル モードでは、閉じられたトランザクション ログ ファイルが、アクティブ データベース コピーから 1 つ以上のパッシブ データベース コピーにプッシュされます。

<!-- end list -->

  - *データベース可用性グループ*  
    一連のレプリケーション データベースをホストする最大 16 台の Exchange 2013 メールボックス サーバーのグループです。

<!-- end list -->

  - *データベース モビリティ*  
    Exchange 2013 メールボックス データベースを、他の Exchange 2013 メールボックス サーバーにレプリケートおよびマウントする機能です。

<!-- end list -->

  - *データセンター*  
    通常、Active Directory サイトを示しますが、物理的なサイトを示すこともあります。このドキュメントでは、データ センターは Active Directory サイトと同じです。

<!-- end list -->

  - *データセンターのアクティブ化調整モード*  
    DAG 設定のプロパティ。有効にすると、Microsoft Exchange レプリケーション サービスが起動時にデータベースをマウントするアクセス許可を取得するよう強制します。

<!-- end list -->

  - *障害回復*  
    障害から回復するための手動による処理です。この障害には、1 つのアイテムに影響するものと、物理的な場所全体に影響するものとがあります。

<!-- end list -->

  - *Exchange サード パーティ レプリケーション API*  
    DAG で、連続レプリケーションの代わりにサード パーティの同期レプリケーションを使用できるようにする Exchange の API です。

<!-- end list -->

  - *高可用性*  
    サービスの可用性、データの可用性、およびサービスまたはデータに影響する障害 (ネットワーク、ストレージ、またはサーバーの障害など) からの自動回復を提供するソリューションです。

<!-- end list -->

  - *増分展開*  
    Exchange 2013 のインストール後に高い可用性とサイト復元を展開する機能です。

<!-- end list -->

  - *時間差メールボックス データベース コピー*  
    ログ再生ラグ タイムが 0 より大きい、パッシブなメールボックス データベース コピーです。

<!-- end list -->

  - *メールボックス データベース コピー*  
    アクティブまたはパッシブのいずれかのメールボックス データベース (.edb ファイルとログ) です。

<!-- end list -->

  - *メールボックスの復元*  
    Exchange 2013 の統合された高可用性とサイト復元ソリューションの名前です。

<!-- end list -->

  - *可用性管理*  
    プローブ、モニター、レスポンダーからなる一連の内部プロセスで、すべてのサーバーの役割とすべてのプロトコルにわたって監視と高可用性を実現します。

<!-- end list -->

  - *\*over* (スター オーバーと読みます)  
    *切り替え*および*フェールオーバー*の短縮名です。切り替えとは、1 つ以上のデータベース コピーを手動でアクティブ化することです。フェールオーバーとは、障害発生後に、1 つ以上のデータベース コピーを自動的にアクティブ化することです。

<!-- end list -->

  - *セーフティ ネット*  
    以前はトランスポート収集と呼ばれていました。これは *X* 日間のすべてのメッセージのコピーを格納するトランスポート サービスの機能です。既定の設定は 2 日間です。

<!-- end list -->

  - *シャドウ冗長*  
    メッセージ送信中の期間全体にわたって冗長性を提供するトランスポート サーバーの機能です。

<!-- end list -->

  - *サイトの復元*  
    メッセージング インフラストラクチャを複数の Active Directory サイトに拡張する構成です。サイトの 1 つに影響を及ぼす障害の発生時にメッセージング システムに対して運用の持続性を提供します。

主要な関連用語

## データベース可用性グループ

DAG は、Exchange 2013 に組み込まれている、高可用性およびサイト復元のフレームワークの基本コンポーネントです。DAG とは、データベースのセットをホストする最大 16 台のメールボックス サーバーからなるグループであり、個々のデータベース、ネットワークまたはサーバーに影響を与える障害から、データベース レベルの自動回復を提供します。DAG 内のサーバーは、DAG 内の他のサーバーからのメールボックス データベースのコピーをホストできます。サーバーは DAG に追加されると、DAG 内の他のサーバーと連動して、ディスク障害やサーバー障害などのメールボックス データベースに影響を与える障害からの自動的な回復を提供します。DAG の詳細については、「[データベース可用性グループ (DAG)](database-availability-groups-dags-exchange-2013-help.md)」を参照してください。

主要な関連用語

## メールボックス データベース コピー

Exchange 2010 で初めて導入された高可用性とサイトの復元は、Exchange 2013 ではデータベース コピーの作成と維持に使用されています。Exchange 2013 では、Exchange によって管理されるデータベース レベルのフェールオーバーであるデータベース モビリティの概念も利用しています。

データベース モビリティは、データベースをサーバーから切り離し、1 つのデータベースで最大 16 個のコピーのサポートを追加します。データベースのコピーを作成できるネイティブな環境も提供します。

データベース コピーをアクティブなメールボックス データベースとして設定することは、*切り替え*と呼ばれます。データベースまたはデータベースのアクセスに影響する障害が発生して新しいデータベースがアクティブ コピーとなる場合、このプロセスは*フェールオーバー*と呼ばれます。またこのプロセスは、障害の発生したサーバー上でオンラインの状態にあったデータベースが、1 つ以上のサーバーでオンラインとなるサーバー障害も意味します。切り替えまたはフェールオーバーのいずれかが発生すると、他の Exchange 2013 サーバーがほぼ即座に切り替えを検知し、クライアントとメッセージング トラフィックを新しいアクティブ データベースにリダイレクトします。

たとえば、基礎記憶域の障害が原因で DAG 内のアクティブ データベースに障害が発生すると、アクティブ マネージャー によって DAG 内の別のメールボックス サーバー上のデータベース コピーにフェールオーバーされ、自動的に回復します。Exchange 2013 では、可用性管理によって、データベースへのプロトコル アクセスの喪失から回復するための新しい動作が追加されています。これには、アプリケーション ワーカー プールのリサイクル、サービスおよびサーバーの再起動とデータベース フェールオーバーの開始が含まれます。

メールボックス データベース コピーの詳細については、「[メールボックス データベース コピー](mailbox-database-copies-exchange-2013-help.md)」を参照してください。

主要な関連用語

## アクティブ マネージャー

Exchange 2013 では、Exchange 2010 に導入されている アクティブ マネージャー のコンポーネントを利用して、データベースとデータベース コピーの正常性、状態、連続レプリケーション、およびメールボックス サーバーの高可用性のその他の面を管理します。アクティブ マネージャー の詳細については、「[アクティブ マネージャー](active-manager-exchange-2013-help.md)」を参照してください。

主要な関連用語

## サイトの復元

Exchange 2013 はメールボックス サーバー役割の高可用性およびサイト復元のために、引き続き DAG および Windows フェールオーバー クラスタリングを使用しますが、Exchange 2013 ではサイト復元は同じではありません。サイト復元は、Exchange 2013 では簡略化されて大幅に改良されています。Exchange 2013 で行われた基礎的なアーキテクチャ変更は、サイト復元構成の回復の点で大きな影響があります。

Exchange 2010 では、メールボックス (DAG) とクライアント アクセス (クライアント アクセス サーバー配列) の回復は合わせて行われていました。クライアント アクセス サーバーのすべて、配列の VIP、または DAG の重要な部分を失った場合、データセンターの切り替えを行う必要がありました。これは文書化されていて一般的によく理解されている処理ですが、実行するには時間がかかり、処理を開始するために人間の手による介入を必要とします。

Exchange 2013 では、何らかの理由 (負荷分散装置のエラーなど) によりクライアント アクセス サーバー配列を失った場合に、データセンターの切り替えを行う必要はありません。構成が適切であれば、フェールオーバーはクライアント レベルで発生し、クライアントはクライアント アクセス サーバー動作している第 2 のデータセンターに自動的にリダイレクトされます。そしてそれらの動作しているクライアント アクセス サーバーは停止の影響を受けずにいる (切り替えをしないため) ユーザーのメールボックス サーバーに通信をプロキシで返します。サービスの回復作業をする代わりにサービスが自身で回復するため、問題の根本的な解決に集中できます (障害の発生した負荷分散装置の交換など)。

さらに、名前空間の単純化、サーバー役割の統合、Active Directory サイト サーバー役割要件の分離、クライアント アクセス サーバー配列と DAG 回復の分離、および負荷分散の変更によって、Exchange 2013 では、クライアント アクセス サーバーと DAG 両方の回復を分離してサイト全体で自動化できるようになりました。その結果、場所が 3 つある場合のデータセンターのフェールオーバーのシナリオに対応できるようになりました。

Exchange 2010 では、2 つのデータセンターにまたがって DAG を展開して、3 番目のデータセンターでホストを監視することで、いずれかのデータセンターのメールボックス役割のフェールオーバーを有効にできました。しかし、メールボックス サーバーの役割以外は手動で名前空間を変更する必要があったため、ソリューション自体のフェールオーバーはありませんでした。

Exchange 2013 では、名前空間は DAG と共に移動する必要はありません。Exchange はフォールト トレランスを利用して、複数の IP アドレス、負荷分散 (および必要に応じて、サーバーをサービスに組み込んだり外したりする機能) を通して名前空間に組み込んでいます。最新の HTTP クライアントはこの冗長性で自動的に動作します。HTTP スタックは完全修飾ドメイン名 (FQDN) に対する複数の IP アドレスを受け付けることができ、最初の IP アドレスの失敗が重大な場合 (接続できないなど)、一覧の次の IP アドレスを試行します。軽微な失敗 (デバイスがパケットを取りこぼしたためサービスを中断する必要があるなどの、サービスの断続的な障害が原因により、セッションの確立後に接続が失われた) では、ユーザーはブラウザーを更新する必要があるかもしれません。

これは、Exchange 2010 のように名前空間が単一障害点であることは、もはやないということを意味しています。Exchange 2010 で、メッセージング システムにおける最大の単一障害点は、ユーザーに付与した FQDN です。なぜなら、それがユーザーの接続先を示しているからです。Exchange 2010 パラダイムでは、FQDN の行き先を変更することは容易ではありません。なぜなら、DNS を変更してから、世界の一部地域では大変な DNS 遅延に対応する必要があるからです。そして、ブラウザーの名前のキャッシュは通常 30 分またはそれ以上留まるため、それについても考慮する必要があります。

Exchange 2013 における変更の 1 つは、クライアントが複数の場所にアクセスできるようにすることです。クライアントが複数の場所を使用できると仮定して (Exchange 2013 のほとんどすべてのクライアント アクセス プロトコルは HTTP ベース (Outlook、Outlook Anywhere、EAS、EWS、OWA、EAC など) で、サポートされているすべての HTTP クライアントが複数の IP アドレスに複数の IP アドレスを設定できます)、クライアント側でフェールオーバーを提供します。名前解決中にクライアントに複数の IP アドレスを渡すように DNS を構成できます。クライアントが mail.contoso.com について問い合わせると、たとえば 2 つの IP アドレスまたは 4 つの IP アドレスが返ってきます。ただし、クライアントが数多く受け取る IP アドレスは確実にクライアントによって使用されます。これにより、IP アドレスの 1 つに障害が発生しても、他に 1 つ以上の IP アドレスへの接続を試すことができるためクライアントが改善されます。クライアントが 1 つの IP アドレスに接続しようとして失敗すると、約 20 秒間待機してから一覧の次の IP アドレスに対して試行します。したがって、クライアント アクセス サーバー配列用の VIP が失われると約 21 秒でクライアントの回復が自動的に発生します。

これによって次のような利点が得られます。

  - Exchange 2010 では、プライマリのデータセンターで負荷分散装置が失われて、そのサイトに別の負荷分散装置がない場合、データセンターの切り替えを行う必要がありました。Exchange 2013 では、プライマリ サイトで負荷分散装置を失った場合、単に負荷分散装置をオフにし (または VIP をオフにし)、修理または交換します。セカンダリ データセンターでまだ VIP を使用していないクライアントは、名前空間や DNS の変更なしにセカンダリの VIP に自動的にフェールオーバーします。これは、切り替えを実行する必要がないというだけでなく、通常データセンターの切り替えの回復に関連する時間がすべて不要になるということも意味します。Exchange 2010 では、DNS 遅延を処理する必要がありました (そのため、TTL (Time to Live) を 5 分に設定し、フェールバック URL の導入が推奨されていました)。Exchange 2013 では、VIP (データセンター) 間で名前空間のフェールオーバーが高速で行われる (20 秒) ためにその必要がありません。

  - データセンター間で名前空間をフェールオーバーできるので、データセンターのフェールオーバーを実現するために必要なのは、複数のデータセンター間でメールボックス役割をフェールオーバーするメカニズムだけです。DAG のフェールオーバーが自動的に行われるようにするには、単に 2 つのデータセンター間で DAG が均等に分割されたソリューションを設計し、第 3 の場所に監視サーバーを配置して、DAG メンバーが含まれるデータセンター間のネットワークの状態に関係なく、いずれかのデータセンターの DAG メンバーによって調停できるようにすることです。2 つのデータセンターのみがあり、3 番目の物理的な場所が使用できない場合、Microsoft Azure 仮想マシンにミラーリング監視サーバーを配置することができます。詳細は「[DAG ミラーリング監視サーバーとしての Microsoft Azure VM の使用](using-a-microsoft-azure-vm-as-a-dag-witness-server-exchange-2013-help.md)」を参照してください。

  - このシナリオでは、管理者は問題の解決に集中することができ、サービスの回復には時間を費やしません。単に障害を修復するだけで、サービス全体は継続して実行中でデータの整合性も維持されています。破損したデバイスを修理するときに感じる切迫感とストレスは、サービスの復元作業で感じる切迫感とストレスとはまるで違います。エンド ユーザーにとっても良いことですし、管理者のストレスも低減されます。

スイッチバック (フェールバックと間違えられることがあります) を実行することなしに、フェールオーバーを発生させることができます。プライマリのデータセンターでクライアント アクセス サーバーを喪失し、その結果クライアントに対してサービスが 20 秒中断しても、フェールバックに気が付かないかもしれません。この時点で、一番の関心は問題の根本を解決することです (たとえば、故障した負荷分散装置の交換)。修理したデバイスがオンラインになって機能が回復すると、一部のクライアントは使用を開始し、残りのクライアントは第 2 のデータセンターを通して作業を続けます。

Exchange 2013 では、管理者が断続的な障害に対処できるようにする機能を提供しています。断続的な障害とは、たとえば、最初の TCP 接続が確立された後に何も起こらない状況です。断続的な障害には、ある種の追加の管理的操作が必要となります。なぜなら、デバイスを交換してサービスに投入した結果の可能性があるからです。この修理のプロセスが発生すると、デバイスの電源がオンになり一部の要求を受け付けますが、必要な構成の手順を実行するまでは実際にクライアントにサービスする準備はできていません。このシナリオでは、管理者は DNS から交換されるデバイス用の VIP を単純に削除することで名前空間の切り替えを実行できます。すると、その修理期間中は、そのデバイスに接続しようとするクライアントはありません。いったん交換処理が完了すると、管理者は VIP を DNS に追加しなおして、クライアントは段階的にそれを使い始めます。

サイトの復元の計画および展開の詳細については、「[高可用性とサイトの復元計画](planning-for-high-availability-and-site-resilience-exchange-2013-help.md)」および「[高可用性とサイト復元の展開](deploying-high-availability-and-site-resilience-exchange-2013-help.md)」を参照してください。

主要な関連用語

## サードパーティ レプリケーション API

Exchange 2013 には、サードパーティ レプリケーション API が搭載されているため、組み込みの連続レプリケーション機能の代わりに、サードパーティの同期レプリケーション ソリューションを使用できます。Microsoft では、この API を使用するサードパーティ ソリューションをサポートします。ただし、API を使用した結果無効となるネイティブの連続レプリケーション機能の代わりとなる必要機能を、そのソリューションがすべて提供することが条件となります。ソリューションがサポート対象となるのは、この API が DAG 内でメールボックス データベース コピーの管理とアクティブ化目的で使用される場合に限定されます。この範囲外で API を使用した場合は、サポート対象外となります。また、ソリューションが Windows ハードウェア サポートの適用可能要件を満たしている必要があります (テスト検証はサポートでは不要です)。

組み込みのサードパーティ製レプリケーション API を使用するソリューションを展開する場合は、主にソリューション ベンダーがソリューションのサポートを担当します。Microsoft は、レプリケートされたソリューションおよびレプリケートされていないソリューションの Exchange データについてサポートします。 データ レプリケーションを使用するソリューションは、データ レプリケーションに関する Microsoft サポート ポリシーに従う必要があります。このサポート ポリシーについては、Microsoft サポート技術情報の記事 895847「[Exchange Server での複数サイト データ レプリケーションのサポート](https://go.microsoft.com/fwlink/p/?linkid=3052%26kbid=895847)」に記載されています。また、Windows フェールオーバー クラスター リソース モデルを利用するソリューションは、Microsoft サポート技術情報の記事 943984「[Windows Server 2008 および Windows Server 2008 R2 フェールオーバー クラスターに関するマイクロソフト サポート ポリシー](https://go.microsoft.com/fwlink/p/?linkid=3052%26kbid=943984)」または「[Windows Server 2012 フェールオーバー クラスターに対するマイクロソフトのサポート ポリシー](https://go.microsoft.com/fwlink/p/?linkid=3052%26kbid=2775067)」に記載されている Windows クラスターのサポート可能要件を満たす必要があります。

サードパーティ製レプリケーション API ベースのソリューションを使用した展開に関する Microsoft のバックアップおよび復元のサポート ポリシーは、ネイティブの連続レプリケーション展開に関するサポート ポリシーと同じです。

サードパーティ API の情報が必要なパートナーの場合、Microsoft の営業担当者にお問い合わせください。

主要な関連用語

## 高可用性とサイトの復元のドキュメント

次の表には、Exchange 2013 の DAG、メールボックス データベースのコピー、およびバックアップと復元の学習や管理に役立つトピックへのリンクが含まれています。


<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>トピック</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><a href="database-availability-groups-dags-exchange-2013-help.md">データベース可用性グループ (DAG)</a></p></td>
<td><p>DAG、アクティブ マネージャー、データセンターのアクティブ化調整 (DAC) モード、およびメールボックス データベースのコピーについて説明します。</p></td>
</tr>
<tr class="even">
<td><p><a href="planning-for-high-availability-and-site-resilience-exchange-2013-help.md">高可用性とサイトの復元計画</a></p></td>
<td><p>全般、ハードウェア、ネットワーク、ソフトウェア、監視サーバーおよびその他の要件および DAG のベスト プラクティスについて説明します。</p></td>
</tr>
<tr class="odd">
<td><p><a href="deploying-high-availability-and-site-resilience-exchange-2013-help.md">高可用性とサイト復元の展開</a></p></td>
<td><p>DAG の展開および構成のための展開シナリオの例を検討します。</p></td>
</tr>
<tr class="even">
<td><p><a href="managing-high-availability-and-site-resilience-exchange-2013-help.md">高可用性とサイト復元の管理</a></p></td>
<td><p>DAG の管理タスク、スイッチ オーバーとフェールオーバー、およびメンテナンス モードについて説明します。</p></td>
</tr>
<tr class="odd">
<td><p><a href="monitoring-database-availability-groups-exchange-2013-help.md">データベース可用性グループの監視</a></p></td>
<td><p>DAG およびデータベース コピーを監視するための、組み込みのコマンドレットとスクリプトについて説明します。</p></td>
</tr>
<tr class="even">
<td><p><a href="backup-restore-and-disaster-recovery-exchange-2013-help.md">バックアップ、復元、および障害回復</a></p></td>
<td><p>Exchange データベース、回復用データベース、およびサーバー回復のバックアップと復元について説明します。</p></td>
</tr>
</tbody>
</table>


主要な関連用語

